{"ast":null,"code":"import axios from\"axios\";import{useState}from\"react\";import{MapContainer,TileLayer,Marker,useMapEvents}from\"react-leaflet\";import'leaflet/dist/leaflet.css';import L from'leaflet';import markerIcon from'leaflet/dist/images/marker-icon.png';import markerShadow from'leaflet/dist/images/marker-shadow.png';import\"../styles/MyPlaceModal.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MyPlaceModal=_ref=>{let{visiable,onClose,accessToken}=_ref;const API_URL=process.env.REACT_APP_API_URL;const[successUpdatePlaceAlert,setSuccessUpdatePlaceAlert]=useState(false);const[latitude,setLatitude]=useState('');const[longitude,setLongitude]=useState('');async function updateMyPlace(){try{const response=await axios.post(`${API_URL}/organizations/update_my_place?latitude=${latitude}&longitude=${longitude}&access_token=${accessToken}`);console.log(response);if(response.status===200){setSuccessUpdatePlaceAlert(true);setTimeout(()=>{setSuccessUpdatePlaceAlert(false);onClose();},1000);}}catch(error){alert(\"Ошибка сервера\");console.log(error);}}const LocationMarker=()=>{useMapEvents({click(e){setLatitude(e.latlng.lat);setLongitude(e.latlng.lng);}});return latitude&&longitude?/*#__PURE__*/_jsx(Marker,{position:[latitude,longitude]}):null;};const DefaultIcon=L.icon({iconUrl:markerIcon,shadowUrl:markerShadow,iconSize:[25,41],iconAnchor:[12,41]});L.Marker.prototype.options.icon=DefaultIcon;if(!visiable)return null;return/*#__PURE__*/_jsx(\"div\",{className:\"my-place-modal-overlay\",onClick:onClose,children:/*#__PURE__*/_jsxs(\"div\",{className:\"my-place-modal-content\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"button\",{className:\"close-button\",onClick:onClose,children:\"\\xD7\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"\\u041C\\u043E\\u0435 \\u043C\\u0435\\u0441\\u0442\\u043E\\u043F\\u043E\\u0436\\u0435\\u043D\\u0438\\u0435\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u0423\\u043A\\u0430\\u0437\\u0430\\u043D\\u0438\\u0435 \\u0441\\u0432\\u043E\\u0435\\u0433\\u043E \\u043C\\u0435\\u0441\\u0442\\u043E\\u043F\\u043E\\u043B\\u043E\\u0436\\u0435\\u043D\\u0438\\u044F, \\u0431\\u0443\\u0434\\u0435\\u0442 \\u0432\\u043B\\u0438\\u044F\\u0442\\u044C \\u043D\\u0430 \\u0441\\u043E\\u0440\\u0442\\u0438\\u0440\\u043E\\u0432\\u043A\\u0443 \\u0441\\u043E\\u0431\\u044B\\u0442\\u0438\\u0439 - \\u043F\\u0435\\u0440\\u0432\\u044B\\u043C\\u0438 \\u0431\\u0443\\u0434\\u0443\\u0442 \\u0443\\u043A\\u0430\\u0437\\u044B\\u0432\\u0430\\u0442\\u044C\\u0441\\u044F \\u0431\\u043B\\u0438\\u0437\\u0436\\u0430\\u0439\\u0448\\u0438\\u0435 \\u043A \\u0412\\u0430\\u043C \\u0441\\u043E\\u0431\\u044B\\u0442\\u0438\\u044F.\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"row g-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-12\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u043C\\u0435\\u0441\\u0442\\u043E \\u043D\\u0430 \\u043A\\u0430\\u0440\\u0442\\u0435\"}),/*#__PURE__*/_jsxs(MapContainer,{center:[55.75,37.605],zoom:13,preferCanvas:true// Ускоряет рендеринг, используя canvas\n,zoomAnimation:false// Отключение анимации зума для повышения производительности\n,scrollWheelZoom:true// Включить прокрутку мыши\n,children:[/*#__PURE__*/_jsx(TileLayer,{url:\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",maxZoom:20// Максимальный зум карты\n,tileSize:256// Размер тайлов\n,updateWhenIdle:true// Загружать только видимые тайлы\n,detectRetina:true// Адаптация для экранов Retina    \n}),/*#__PURE__*/_jsx(LocationMarker,{})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u041A\\u043E\\u043E\\u0440\\u0434\\u0438\\u043D\\u0430\\u0442\\u044B: \",latitude,\" \",longitude]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"col-12\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary\",onClick:updateMyPlace,children:\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"})}),successUpdatePlaceAlert?/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-success\",role:\"alert\",children:\"\\u041C\\u0435\\u0441\\u0442\\u043E\\u043F\\u043E\\u043B\\u043E\\u0436\\u0435\\u043D\\u0438\\u0435 \\u0443\\u0441\\u043F\\u0435\\u0448\\u043D\\u043E \\u0441\\u043E\\u0445\\u0440\\u0430\\u043D\\u0435\\u043D\\u043E!\"}):null]})]})});};export default MyPlaceModal;","map":{"version":3,"names":["axios","useState","MapContainer","TileLayer","Marker","useMapEvents","L","markerIcon","markerShadow","jsx","_jsx","jsxs","_jsxs","MyPlaceModal","_ref","visiable","onClose","accessToken","API_URL","process","env","REACT_APP_API_URL","successUpdatePlaceAlert","setSuccessUpdatePlaceAlert","latitude","setLatitude","longitude","setLongitude","updateMyPlace","response","post","console","log","status","setTimeout","error","alert","LocationMarker","click","e","latlng","lat","lng","position","DefaultIcon","icon","iconUrl","shadowUrl","iconSize","iconAnchor","prototype","options","className","onClick","children","stopPropagation","center","zoom","preferCanvas","zoomAnimation","scrollWheelZoom","url","maxZoom","tileSize","updateWhenIdle","detectRetina","type","role"],"sources":["/home/los/Рабочий стол/Проги/support.rf/support_frontend/src/components/MyPlaceModal.jsx"],"sourcesContent":["import axios from \"axios\";\nimport { useState } from \"react\";\nimport { MapContainer, TileLayer, Marker, useMapEvents } from \"react-leaflet\";\nimport 'leaflet/dist/leaflet.css';\nimport L from 'leaflet';\nimport markerIcon from 'leaflet/dist/images/marker-icon.png';\nimport markerShadow from 'leaflet/dist/images/marker-shadow.png';\nimport \"../styles/MyPlaceModal.css\"\n\nconst MyPlaceModal = ({visiable, onClose, accessToken}) => {\n    const API_URL = process.env.REACT_APP_API_URL; \n    const [successUpdatePlaceAlert, setSuccessUpdatePlaceAlert] = useState(false); \n    const [latitude, setLatitude] = useState('');\n    const [longitude, setLongitude] = useState('');\n\n    async function updateMyPlace() {\n        try {\n            const response = await axios.post(`${API_URL}/organizations/update_my_place?latitude=${latitude}&longitude=${longitude}&access_token=${accessToken}`);\n            console.log(response);\n            \n            if (response.status === 200) {\n                setSuccessUpdatePlaceAlert(true);\n                setTimeout(() => {\n                    setSuccessUpdatePlaceAlert(false);\n                    onClose();\n                }, 1000);\n            }\n        }\n        catch(error) {\n            alert(\"Ошибка сервера\");\n            console.log(error);\n            \n        }\n    }\n\n    const LocationMarker = () => {\n        useMapEvents({\n            click(e) {\n                setLatitude(e.latlng.lat);\n                setLongitude(e.latlng.lng);\n            },\n        });\n\n        return latitude && longitude ? (\n            <Marker position={[latitude, longitude]} />\n        ) : null;\n    };\n\n    const DefaultIcon = L.icon({\n        iconUrl: markerIcon,\n        shadowUrl: markerShadow,\n        iconSize: [25, 41],\n        iconAnchor: [12, 41],\n      });\n      \n    L.Marker.prototype.options.icon = DefaultIcon;\n\n    if (!visiable) return null;\n\n    return(\n        <div className=\"my-place-modal-overlay\" onClick={onClose}>\n            <div \n                className=\"my-place-modal-content\" \n                onClick={(e) => e.stopPropagation()} \n            >\n                <button \n                    className=\"close-button\" \n                    onClick={onClose}\n                >\n                    &times;\n                </button>\n                <h2>Мое местопожение</h2>\n                <p>Указание своего местоположения, будет влиять на сортировку \n                    событий - первыми будут указываться близжайшие к Вам события.</p>\n                <form className=\"row g-3\">\n                    <div className=\"col-12\">\n                        <label className=\"form-label\">Выберите место на карте</label>\n                        <MapContainer \n                            center={[55.75, 37.605]} \n                            zoom={13}\n                            preferCanvas={true} // Ускоряет рендеринг, используя canvas\n                            zoomAnimation={false} // Отключение анимации зума для повышения производительности\n                            scrollWheelZoom={true} // Включить прокрутку мыши\n                        >\n                            <TileLayer\n                                url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n                                maxZoom={20} // Максимальный зум карты\n                                tileSize={256} // Размер тайлов\n                                updateWhenIdle={true} // Загружать только видимые тайлы\n                                detectRetina={true} // Адаптация для экранов Retina    \n                            />\n                            <LocationMarker />\n                        </MapContainer>\n                        <p>\n                            Координаты: {latitude} {longitude}\n                        </p>\n                    </div>\n                    <div className=\"col-12\">\n                        <button \n                            type=\"submit\" \n                            className=\"btn btn-primary\"\n                            onClick={updateMyPlace}\n                        >\n                            Сохранить\n                        </button>\n                    </div>\n                    { successUpdatePlaceAlert\n                        ?\n                    <div className=\"alert alert-success\" role=\"alert\">\n                        Местоположение успешно сохранено!\n                    </div>\n                        : null\n                    }\n                </form>\n            </div>\n        </div>\n    );\n}\n\nexport default MyPlaceModal;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}